name: Initialise the app environment

inputs:
  node-version:
    required: true
    type: string

runs:
  using: 'composite'
  steps:
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '${{ inputs.node-version }}'

  	- name: Cache dependencies
    	uses: actions/cache@v1
    	with:
      	path: ~/.npm
      	key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
      	restore-keys: |
        	${{ runner.os }}-node-

  	- run: npm ci
  	- run: npm run build

  	- name: Deploy
    	uses: Stephen-vellaichamy-selvaraj/Contentful-Jamstack@main
    	with:
      	deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }}
      	publish_dir: _site   
